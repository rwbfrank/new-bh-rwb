jQuery(document).ready(function(a){"use strict";function e(){window.console&&console.log.apply(console,arguments)}function t(){window.console&&console.warn.apply(console,arguments)}function i(a,e){a.find('.fw-wizard-step[data-stepId="'+e+'"]').removeClass("fw-current"),a.find('.fw-wizard-step-header[data-stepId="'+e+'"]').removeClass("fw-current"),a.find('.fw-progress-step[data-id="'+e+'"]').removeClass("fw-active"),a.find('.fwp-progress-bar .fwp-circle[data-id="'+e+'"]').removeClass("fwp-active")}function r(a,e){a.find('.fw-wizard-step[data-stepId="'+e+'"]').addClass("fw-current"),a.find('.fw-wizard-step-header[data-stepId="'+e+'"]').addClass("fw-current"),a.find('.fw-progress-step[data-id="'+e+'"]').addClass("fw-active")}function n(){var e=m(a(this)),t=h(e),n=parseInt(t,10),s=e.find('.fwp-progress-bar .fwp-circle[data-id="'+t+'"]'),f=e.find('.fwp-progress-bar .fwp-bar[data-id="'+(n-1)+'"]');e.find('.fw-progress-step[data-id="'+(n-1)+'"]').removeClass("fw-visited"),e.find('.fw-progress-step[data-id="'+t+'"]').removeClass("fw-visited"),s.removeClass("fwp-done"),5==n&&e.find(".fw-progress-bar").removeClass("fw-step-after-fifth"),s.find(".fwp-label").html(parseInt(t,10)+1),f.removeClass("fwp-active"),n>=2&&e.find('.fwp-progress-bar .fwp-bar[data-id="'+(n-2)+'"]').removeClass("fwp-done").addClass("fwp-active"),i(e,t--),e.find('.fwp-progress-bar .fwp-circle[data-id="'+t+'"]').find(".fwp-label").html(parseInt(t,10)+1),r(e,t),0===t&&function(a){a.find(".fw-button-previous").hide()}(e),function(a){a.find(".fw-button-next").show()}(e)}function s(){var e=m(a(this)),t=h(e),n=parseInt(t,10),s=e.find('.fwp-progress-bar .fwp-circle[data-id="'+t+'"]'),f=e.find('.fwp-progress-bar .fwp-bar[data-id="'+t+'"]');S(t)&&(e.find('.fw-progress-step[data-id="'+t+'"]').addClass("fw-visited"),4==n&&e.find(".fw-progress-bar").addClass("fw-step-after-fifth"),s.removeClass("fwp-active").addClass("fwp-done"),s.find(".fwp-label").html("&#10003;"),f.addClass("fwp-active"),n>=1&&e.find('.fwp-progress-bar .fwp-bar[data-id="'+(n-1)+'"]').removeClass("fwp-active").addClass("fwp-done"),i(e,t++),r(e,t),t===b(e)-1&&function(a){a.find(".fw-button-next").hide()}(e),function(a){a.find(".fw-button-previous").show()}(e),a("html, body").animate({scrollTop:a("#multi-step-form").offset().top-100},500))}function f(a,e,t,i,r){var n={};i?(n[t]=i,j(a,e).push(n)):"true"==r&&(n['<p class="fw-step-summary fw-summary-invalid">'+t]="</p>",j(a,e).push(n))}function d(e,t,i){var r=t.attr("data-required");switch(t.attr("data-type")){case"fw-email":case"fw-date":case"fw-text":!function(a,e,t,i){f(a,t,e.find("h3").text(),e.find(".fw-text-input").val(),i)}(e,t,i,r);break;case"fw-textarea":!function(a,e,t,i){f(a,t,e.find("h3").text(),e.find(".fw-textarea").val(),i)}(e,t,i,r);break;case"fw-radio":!function(e,t,i,r){var n=t.find("h3").text(),s="";t.find(".fw-choice").each(function(e,t){a(t).find("input").is(":checked")&&(""!=s&&(s+=", "),s+=a(t).find("label").text())}),f(e,i,n,s,r)}(e,t,i,r);break;case"fw-select":!function(a,e,t,i){f(a,t,e.find("h3").text(),e.find("select").select2("data")[0].text,i)}(e,t,i,r);break;case"fw-checkbox":!function(a,e,t,i){var r,n=e.find("label").text();e.find(".fw-checkbox").is(":checked")&&(r="yes"),e.hasClass("fw-block-invalid"),f(a,t,n,r,i)}(e,t,i,r);break;case"fw-registration":!function(a,e,t,i){var r=ajax.i18n.registration,n=e.find(".msfp-registration-input[data-id=username]").val(),s=e.find(".msfp-registration-input[data-id=email]").val();f(a,t,r,n&&s?n+" ("+s+")":ajax.i18n.registrationFailed,i)}(e,t,i,r)}}function o(e,t,i){return e.find('.fw-wizard-step[data-stepId="'+t+'"]').find(".fw-step-part").each(function(e,t){var r=a(t).find(".fw-step-part-title").text().trim();a(t).find('.fw-step-block:not(.fw-step-block[style="display: none;"] > .fw-step-block):not(.msfp-block-conditional)').each(function(e,t){d(i,a(t),r)})}),""}function l(){var e=[];return a(".fw-step-block[data-type=fw-file]").each(function(a,t){c(t,e)}),e}function c(e,t){for(var i=a(e).find("input")[0].files,r=0;r<i.length;r++)t.push(i[r].name)}function p(a){var e,t=b(a),i={};for(e=0;e<t;e++)o(a,e,i);return i}function u(a){var e="",t=p(a);for(var i in t)e+='<div class="fw-step-summary-part">',e+=function(a){return'<p class="fw-step-summary-title">'+a+"</p>"}(i),e+=function(a){var e,t,i="";for(e=0,t=a.length;e<t;e++)i+=w(a[e]);return i}(t[i]),e+="</div>";return e}function w(a){var e,t="";for(e in a)t='<p class="fw-step-summary">'+e+" â€” "+a[e]+"</p>";return t}function v(e){var t=u(e),i=e.find(".fw-wizard-summary");i.empty(),i.append(t),a(".fw-toggle-summary").toggle(function(){a(".fw-wizard-summary").slideDown(),a(".fw-toggle-summary").text(ajax.i18n.hideSummary)},function(){a(".fw-wizard-summary").slideUp(),a(".fw-toggle-summary").text(ajax.i18n.showSummary)}),a(".fw-summary-invalid").length?i.prepend('<div class="fw-summary-alert">'+R[2]+"</div>"):a(".fw-summary-alert").remove()}function m(a){return a.closest(".fw-wizard")}function b(a){return a.attr("data-stepCount")}function h(a){return a.find(".fw-current").attr("data-stepId")}function g(a){return a.closest(".fw-wizard-step").attr("data-stepId")}function k(a){return a.closest(".fw-step-part").attr("data-partId")}function x(a){return a.closest(".fw-step-block").attr("data-blockId")}function C(a){var t=[].slice.call(arguments,1),i=0,r=t.length;if(e("args",t),"0"===t[0])throw new TypeError;for(;i<r;i++)a=function(a,e){a[e]||(a[e]={});return a[e]}(a,t[i]);return a}function y(a,e){var t=g(e),i=k(e),r=x(e);return C(E,a.attr("id"),t,i,r)}function j(a,e){return a[e]||(a[e]=[]),a[e]}function z(){var e=a(this),t=m(e),i=e.prop("checked"),r=y(t,e),n=e.attr("data-id");i?r[n]="checked":delete r[n],v(t)}function T(){var e=a(this),t=e.attr("data-id"),i=e.closest(".fw-conditional");i.find(".fw-conditional-then").removeClass("fw-selected"),i.find('.fw-conditional-then[data-id="'+t+'"]').addClass("fw-selected")}function _(){var t=a(this),i=m(t);!function(t,i){var r,n,s=t.attr("id"),f=i.attr("name"),d=x(i),o=a('.fw-radio[name="'+f+'"]'),l=!1;e("radios",o),o.each(function(e,t){d!==x(a(t))&&(l=!0)}),r=g(i),n=k(i),l?delete C(E,s,r)[n]:delete C(E,s,r,n)[d],v(t)}(i,t);y(i,t)[t.attr("data-id")]="checked",v(i)}function I(){var t=a(this),i=m(t),r=t.val();e(r);var n=t.attr("data-id");y(i,t)[n]=r,t.parents(".fw-step-block").removeClass("fw-block-invalid"),t.parents(".fw-step-block").find(".fw-block-invalid-alert").remove(),v(i)}function F(a){var e=a.find(".fw-text-input").val();return!(!e||!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e))||(a.addClass("fw-block-invalid"),!1)}function S(e){var t=!0,i=!0,r=!0;return a('.fw-wizard-step[data-stepid="'+e+'"] .fw-step-block[data-required="true"]:visible').each(function(e,n){var s=a(n);switch(s.attr("data-type")){case"fw-radio":t=function(e){var t=!1;return e.children(".fw-choice").find("input").each(function(e,i){a(i).is(":checked")&&(t=!0)}),t||e.addClass("fw-block-invalid"),t}(s);break;case"fw-select":t=function(a){var e=!1;return a.find("select").val()&&(e=!0),e}(s);break;case"fw-textarea":t=function(a){return!!a.find(".fw-textarea").val()||(a.addClass("fw-block-invalid"),!1)}(s);break;case"fw-text":t=function(a){return!!a.find(".fw-text-input").val()||(a.addClass("fw-block-invalid"),!1)}(s);break;case"fw-email":t=F(s),i=t;break;case"fw-file":t=function(a){return!!a.find(".fw-file-upload-input").val()||(a.addClass("fw-block-invalid"),!1)}(s);break;case"fw-date":t=function(a){return!!a.find(".fw-text-input").val()||(a.addClass("fw-block-invalid"),!1)}(s);break;case"fw-checkbox":t=function(a){return!!a.find(".fw-checkbox").prop("checked")||(a.addClass("fw-block-invalid"),!1)}(s);break;case"fw-submit":t=function(a){var e=a.find("[data-id=name]").val(),t=a.find("[data-id=email]").val(),i=!0;return e&&t||(a.has("input")?i=!0:(a.addClass("fw-block-invalid"),i=!1)),i}(s);break;case"fw-registration":t=function(a){var e=!0,t=a.find("[data-id=username]"),i=a.find("[data-id=email]"),r=t.hasClass("msfp-reg-username-valid"),n=i.hasClass("msfp-reg-email-valid");return r||(a.addClass("fw-block-invalid"),t.removeClass("msfp-reg-username-valid"),t.addClass("msfp-registration-invalid"),e=!1),n||(a.addClass("fw-block-invalid"),i.removeClass("msfp-reg-email-valid"),i.addClass("msfp-registration-invalid"),e=!1),e}(s)}t||(r=!1)}),a('.fw-wizard-step[data-stepid="'+e+'"] .fw-step-block[data-type="fw-email"]').each(function(e,i){var n=a(i);""!=n.find(".fw-text-input").val()&&((t=F(n))||(r=!1))}),r||(a(".fw-block-invalid").each(function(e,t){a(t).find(".fw-block-invalid-alert").length<1&&("fw-registration"==a(t).attr("data-type")?a(t).append('<div class="fw-block-invalid-alert">'+ajax.i18n.errors.checkFields+"</div>"):a(t).append('<div class="fw-block-invalid-alert">'+R[1]+"</div>"))}),function(e,t){a(".fw-alert-user").empty().removeClass("fw-alert-user-fail fw-alert-user-success"),t?a(".fw-alert-user").addClass("fw-alert-user-success").append('<i class="fa fa-check-circle" aria-hidden="true"></i>'):a(".fw-alert-user").addClass("fw-alert-user-fail").append('<i class="fa fa-times-circle" aria-hidden="true"></i>');a(".fw-alert-user").append(e).fadeIn().delay(2e3).fadeOut()}(R[0],!1)),r}function q(e){var i,r,n,s=[],f=a(this).closest(".fw-wizard");a(".fw-block-invalid").each(function(e,t){a(t).removeClass("fw-block-invalid")}),function(e){var t=!0;return a(".fw-wizard-step").each(function(e,i){a(i),S(e)||(t=!1)}),t}()&&(a(".fw-spinner").show(),i=p(f),s=l(),r=f.find('[data-id="email"]').first().val(),f.find("[data-type=fw-registration]")&&(n=function(){var e={};return a(".msfp-registration-input").each(function(t,i){var r=a(i).attr("data-id");e[r]=a(i).val()}),e}()),function(e,i,r,n){var s=a("#multi-step-form").attr("data-wizardid");a(".fw-btn-submit").html('<i class="fa fa-spinner"></i> '+ajax.i18n.sending),a.post(ajax.ajaxurl,{action:"fw_send_email",id:s,fw_data:e,email:i,reg:n,attachments:r,nonce:ajax.nonce},function(e){var t=a(".fw-container").attr("data-redirect");t?(window.onbeforeunload=null,window.location.href=t):(a(".fw-btn-submit").addClass("fw-submit-success").html('<i class="fa fa-check-circle"></i> '+ajax.i18n.submitSuccess),a(".fw-btn-submit").unbind("click"))}).fail(function(e){a(".fw-btn-submit").addClass("fw-submit-fail").html('<i class="fa fa-times-circle"></i> '+ajax.i18n.submitError),t("response",e),t("responseText",e.responseText)})}(i,r,s,n))}function O(e,i){var r=a("#multi-step-form").attr("data-wizardid"),n=a(e.target).prop("files"),s=new FormData;s.append("action","fw_upload_file");for(var f=0;f<n.length;f++)s.append("file"+f,n[f]);s.append("id",r),s.append("nonce",ajax.nonce),i.find("i").removeClass("fa-upload fa-times-circle fa-check-circle").addClass("fa-spinner"),i.find("span").text(ajax.i18n.uploadingFile);var d=a(e.target).parent().parent();a.ajax({type:"POST",url:ajax.ajaxurl,data:s,contentType:!1,processData:!1,dataType:"json",success:function(e){if(a("#multi-step-form").length&&(window.onbeforeunload=function(){return D(l()),"Your uploaded files were deleted from the server for security reasons."}),e.success){d.attr("data-uploaded","true"),i.find("i").removeClass("fa-times-circle fa-spinner").addClass(" fa-check-circle");for(var r="",s=0;s<n.length;s++)s>0&&(r+=", "),r+=n[s].name;i.find("span").html(r)}else i.find("i").removeClass("fa-spinner fa-check-circle").addClass("fa-times-circle"),i.find("span").html(e.error),t(e.error)},fail:function(a){}})}function D(e){a.post(ajax.ajaxurl,{action:"fw_delete_files",filenames:e,nonce:ajax.nonce},function(e){e&&a("[data-type=fw-file]").each(function(e,t){var i=a(t).find("input");i.replaceWith(i.val("").clone(!0)),a(t).find("label > i").removeClass("fa-check-circle").addClass("fa-upload"),a(t).find("label > span").text(ajax.i18n.chooseFile),a(t).attr("data-uploaded","false")})}).fail(function(a){t("response",a),t("responseText",a.responseText)})}function P(){var e=a(".msfp-registration-input[data-id=email]"),i=a(".msfp-registration-input[data-id=username]");e.closest(".fw-step-block");e.on("input",function(i){!function(e){var i=e.closest(".fw-step-block"),r={action:"msfp_pre_validate_reg_email",email:e.val(),nonce:ajax.nonce};a.ajax({type:"POST",url:ajax.ajaxurl,data:r,dataType:"json",success:function(a){a.success?(e.removeClass("msfp-registration-invalid"),e.addClass("msfp-reg-email-valid"),e.next().next().remove(".fw-block-invalid-alert"),i.find(".msfp-reg-username-valid").length>0&&i.removeClass("fw-block-invalid")):(i.addClass("fw-block-invalid"),e.addClass("msfp-registration-invalid"),e.removeClass("msfp-reg-email-valid"),e.next().next().hasClass("fw-block-invalid-alert")||e.next().after('<div class="fw-block-invalid-alert">'+a.error+"</div>"))},fail:function(a){valid=!1,t("response",a),t("responseText",a.responseText)}})}(e)}),i.on("input",function(e){!function(e){var i=e.closest(".fw-step-block"),r={action:"msfp_pre_validate_reg_username",username:e.val(),nonce:ajax.nonce};a.ajax({type:"POST",url:ajax.ajaxurl,data:r,dataType:"json",success:function(a){a.success?(e.removeClass("msfp-registration-invalid"),e.addClass("msfp-reg-username-valid"),e.next().next().remove(".fw-block-invalid-alert"),i.find(".msfp-reg-email-valid").length>0&&i.removeClass("fw-block-invalid")):(i.addClass("fw-block-invalid"),e.removeClass("msfp-reg-username-valid"),e.addClass("msfp-registration-invalid"),e.next().next().hasClass("fw-block-invalid-alert")||e.next().after('<div class="fw-block-invalid-alert">'+a.error+"</div>"))},fail:function(a){valid=!1,t("response",a),t("responseText",a.responseText)}})}(i)})}function A(){var e=a(".fw-wizard");e.each(function(e,t){r(a(t),0)});var t=b(e),i=e.parent().outerWidth();(t>=5&&i>=769||i>=500)&&e.addClass("fw-large-container"),a('.fw-progress-step[data-id="0"]').addClass("fw-active"),a(".fw-button-previous").hide(),a(".fw-button-previous").click(n),a(".fw-button-next").click(s);"off"==a(".fw-wizard-summary").attr("data-showsummary")&&a(".fw-toggle-summary").remove(),a(".fw-checkbox").change(z),a(".fw-radio").change(_),a(".fw-radio-conditional").change(T),a(".fw-text-input").on("change input",I),a(".fw-textarea").on("change input",I),a(".fw-checkbox, .fw-radio").on("change",function(){a(this).parents(".fw-step-block").removeClass("fw-block-invalid"),a(this).parents(".fw-step-block").find(".fw-block-invalid-alert").remove()}),a(".msfp-registration-input").change(I),a("select").each(function(e,t){a(t).data("search")?a("select").select2({allowClear:!0,placeholder:""}):a(t).select2({minimumResultsForSearch:1/0,allowClear:!0,placeholder:""})}),a(".fw-file-upload-input").each(function(){var e=a(this),t=e.next("label"),i=t.html(),r=e.parent().parent();e.on("change",function(a){var e="";a.target.value&&(e=a.target.value.split("\\").pop()),e?O(a,t):t.html(i)}),e.on("click",function(a){if(a.target.value){var e=[];c(r,e),D(e)}}),e.on("focus",function(){e.addClass("has-focus")}).on("blur",function(){e.removeClass("has-focus")})}),function(){var e=a(".fw-datepicker-here").attr("data-dateformat");a(".fw-datepicker-here").datepicker({dateFormat:e})}(),a(".fw-btn-submit").click(q),function(){var e=a(".fw-progress-bar").attr("data-activecolor"),t=a(".fw-progress-bar").attr("data-donecolor"),i=a(".fw-progress-bar").attr("data-nextcolor"),r=a(".fw-progress-bar").attr("data-buttoncolor");a("head").append('<style id="fw-colors"></style>'),e&&a("head").append("<style>.fw-active .progress, ul.fw-progress-bar li.fw-active:before{background:"+e+"!important;} [data-type=fw-checkbox] input[type=checkbox]:checked+label:before, ul.fw-progress-bar li.fw-active .fw-txt-ellipsis { color: "+e+" !important; } .fw-step-part { border-color: "+e+" !important; }</style>"),t&&a("head").append("<style>ul.fw-progress-bar .fw-active:last-child:before, .fw-progress-step.fw-visited:before{ background:"+t+" !important; } .fw-progress-step.fw-visited, ul.fw-progress-bar .fw-active:last-child .fw-txt-ellipsis, .fw-progress-step.fw-visited .fw-txt-ellipsis { color:"+t+" !important;} ul.fw-progress-bar li.fw-visited:after, .fw-progress-step.fw-visited .fw-circle, .fw-progress-step.fw-visited .fw-circle-1, .fw-progress-step.fw-visited .fw-circle-2{ background-color:"+t+" !important;}</style>"),i&&a("head").append("<style>ul.fw-progress-bar li:before{background:"+i+" !important;} .fw-progress-bar li.fw-active:after, li.fw-progress-step::after, .fw-circle, .fw-circle-1, .fw-circle-2{ background-color:"+i+" !important;} .fw-txt-ellipsis { color: "+i+" !important; } </style>"),r&&a("head").append("<style>.fw-button-previous, .fw-button-next, .fw-button-fileupload { background: "+r+" !important; }</style>")}(),P(),v(a(".fw-wizard"))}var E={},R=[ajax.i18n.errors.requiredFields,ajax.i18n.errors.requiredField,ajax.i18n.errors.someRequired+"<br>"+ajax.i18n.errors.checkFields];a(document).ready(function(e){a("#multi-step-form").length&&A()})}),function(){"use strict"}();